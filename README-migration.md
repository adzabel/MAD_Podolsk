# Миграция фронтенда на Vite

Коротко: Vite использует исходники в `docs/` (ваша текущая разметка/стили/скрипты) и собирает готовый сайт в `dist/`.

Файлы, которые добавлены:
- `package.json` — скрипты `dev`, `build`, `preview` и зависимость `vite`.
- `vite.config.js` — конфигурация: `root: 'docs'`, `outDir: '../dist'`, `base: './'`.
- `.github/workflows/deploy-vite.yml` — CI: `npm ci`, `npm run build`, deploy via `rsync`.

Как запустить локально (требуется Node.js >=18, npm):

1) Установить зависимости:

```bash
npm ci
```

2) Разработка (локальный сервер с HMR):

```bash
npm run dev
# сайт будет доступен по http://localhost:5173
```

3) Сборка для продакшена (создаёт `dist/`):

```bash
npm run build
# ./dist/ — готовый сайт для размещения
```

4) Быстрый просмотр собранного результата (локальный статический сервер):

```bash
npm run preview
# откроется у http://localhost:4173
```

Проверки и рекомендации по сохранению верстки:
- Я не менял `docs/index.html`, `docs/css/*` и `docs/js/*`. Это значит, что все классы и id сохранены.
- Vite преобразует импорты ES-модулей и пересоберёт `js/*.js` в бандлы, но ваши имена классов в HTML/CSS не меняются.
- После сборки откройте `dist/index.html` и визуально сверяйте страницы с текущим `docs/index.html`.
- Если у вас есть внешние зависимости, использующие глобальные имена, проверьте консоль браузера на ошибки.

CI / деплой:
- Добавленный workflow `deploy-vite.yml` выполняется при пуше в `main` и делает:
  - `npm ci`
  - `npm run build` (создаёт `./dist/`)
  - деплой `./dist/` на `u3330235@37.140.192.181:/var/www/u3330235/data/www/podolsk.mad.moclean.ru/` через `rsync`.
- Используется секрет GitHub `SSH_PRIVATE_KEY_MAD` (как в старом workflow). Ничего не менял в названии секрета.

Тесты: проверка сборки (локально или в CI) — команда `npm run build`. Если Node в контейнере отсутствует, выполните эти команды на вашей машине с Node.

Если хотите, могу:
- запустить локальную сборку в этом контейнере (если Node/npm доступны); либо
- обновить workflow, чтобы дополнительно запускать линтеры/тесты перед деплоем.
